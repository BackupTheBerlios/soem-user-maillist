<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Soem-user] First questions about SOEM
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/soem-user/2011-November/index.html" >
   <LINK REL="made" HREF="mailto:soem-user%40lists.berlios.de?Subject=Re%3A%20%5BSoem-user%5D%20First%20questions%20about%20SOEM&In-Reply-To=%3C20111101172930.M74213%40etfbl.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000035.html">
   <LINK REL="Next"  HREF="000037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Soem-user] First questions about SOEM</H1>
    <B>Mladen Knezic</B> 
    <A HREF="mailto:soem-user%40lists.berlios.de?Subject=Re%3A%20%5BSoem-user%5D%20First%20questions%20about%20SOEM&In-Reply-To=%3C20111101172930.M74213%40etfbl.net%3E"
       TITLE="[Soem-user] First questions about SOEM">mladen_knezic at etfbl.net
       </A><BR>
    <I>Tue Nov  1 18:37:56 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000035.html">[Soem-user] First questions about SOEM
</A></li>
        <LI>Next message: <A HREF="000037.html">[Soem-user] First questions about SOEM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 01 Nov 2011 13:16:36 +0100, Arthur Ketels wrote
&gt;<i> Hello Leopold,
</I>&gt;<i> 
</I>&gt;<i> Op 1-11-2011 12:00, <A HREF="https://lists.berlios.de/mailman/listinfo/soem-user">soem-user-request at lists.berlios.de</A> schreef:
</I>&gt;<i> &gt; A Dilluns 31 Octubre 2011, Mladen Knezic va escriure:
</I>&gt;<i> &gt;&gt; &gt;  On Mon, 31 Oct 2011 22:56:07 +0100, Leopold Palomo Avellaneda wrote
</I>&gt;<i> &gt;&gt; &gt;  
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  A Dilluns 31 Octubre 2011, Mladen Knezic va escriure:
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  [...]
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  On the same interface?
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  yes,, but using the ethercat master driver from the other 
</I>project.
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  Which one? IgH Etherlab, TwinCAT? Some other library?
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  IgH Etherlab. We are using a GNU/Linux box.
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  Which device?
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  the ethercat device? it's a Bosch Rexroth Indradrive 
</I>controller.
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  So, it is the same device.
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  Yes, the only one we have ...
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  Slaveinfo example should show you
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  infromation about device attached to the interface. 
</I>If it is not
&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  the case you have either communicating over the wrong 
</I>interface
&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  (not one that the ethercat device is attached to) or 
</I>something is
&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  definitely wrong with your system.:)
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  the question is which is wrong?
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;   From your last post I can see that soem successfully 
</I>connects
&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  to the raw socket, but it does not &quot;see&quot; any device 
</I>on the bus.
&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;   From that, I can only conclude that there is no 
</I>attached ethercat
&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  &gt;  devices on the interface you are using.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  &gt;  Ok, some other idea?
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  I would try &quot;slaveinfo&quot; example. This example has only acyclic
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  communication without making slave goes into the OP state. It
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  communicates with device over the CoE protocol to find some 
</I>essential
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  information about the device. If that does not work, my next
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  assumption that something is wrong with the connection. Try 
</I>with
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  different cable, or with different NIC.
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  ok, thanks for the ideas. We are now in some kind of local 
</I>holiday.
&gt;<i> &gt;&gt;&gt; &gt;  &gt;  On Wednesday  I will try the slave info and another NIC to 
</I>checkit.
&gt;<i> &gt;&gt;&gt; &gt;  &gt;  Do you have had configure in some way the NIC to make it works 
</I>with SOEM?
&gt;<i> &gt;&gt; &gt;  
</I>&gt;<i> &gt;&gt; &gt;  No. Just specify the interface name. It should work (at least for 
</I>me).:)
&gt;<i> &gt; well, I have just to load the module and no configuration done. No IP, 
</I>gw, ....
&gt;<i> &gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  P.S. I have found some datasheet
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  (<A HREF="http://www.boschrexroth.com/country_units/">http://www.boschrexroth.com/country_units/</A>
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  europe/france/fr/branches/branches/handling/ressources/
</I>documentation/pr
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  odu its/ IndraDrive_Mi.pdf) and info
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  (<A HREF="http://www.boschrexroth.com/dcc/Vornavigation/">http://www.boschrexroth.com/dcc/Vornavigation/</A>
</I>&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  Vornavi.cfm?&amp;language=en&amp;PageID=p146813). They does not state 
</I>that
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  drive supports EtherCAT communication. Can you confirm that 
</I>this is
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  the drive you are using, or send me a link with info about 
</I>your
&gt;<i> &gt;&gt;&gt;&gt; &gt;  &gt;  &gt;  device?
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  Indradrive HCS02. It's a multiprotocol device, with SercosIII,
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  Ethercat and Ethernet/IP . Now it's activated the Ethercat 
</I>protocol.
&gt;<i> &gt;&gt;&gt; &gt;  &gt;  The page is:
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  
</I>&gt;<i> &gt;&gt;&gt; &gt;  &gt;  <A HREF="http://www.boschrexroth.com/modules/BRMV2PDFDownload.dll?">http://www.boschrexroth.com/modules/BRMV2PDFDownload.dll?</A>
</I>&gt;<i> &gt;&gt; &gt;  
</I>&gt;<i> &gt;&gt; &gt;  
</I>db=brmv2&amp;lvid=90389&amp;mvid=5262&amp;clid=20&amp;sid=DD1441493B9F589CC877A37F9F3C69E0&amp;
&gt;<i> &gt;&gt; &gt;  sch=M
</I>&gt;<i> &gt;&gt; &gt;  
</I>&gt;<i> &gt;&gt; &gt;  Ok, thanx. I will examine the datasheet to see if there is something 
</I>that I
&gt;<i> &gt;&gt; &gt;  have missed. In any case, I believe that you have configured the 
</I>device
&gt;<i> &gt;&gt; &gt;  correctly. If so, there should be no problem with &quot;slaveinfo&quot; to work.
</I>&gt;<i> &gt; Ok, I will check it. .. I'm really impatient ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Leo
</I>&gt;<i> If simple_test reports no slaves found it can have following reasons:
</I>&gt;<i> 1) No slaves attached
</I>&gt;<i> 2) NIC driver is in a wrong mode (do you have installed the IgH rt 
</I>&gt;<i> drivers?), use only vanilla NIC drivers.
</I>
EtherLab RT drivers can be disabled. You have to unload the EtherLab Master 
module (in my system it is placed in /opt/etherlab/etc/init.d/ethercat, but 
it depends where have you installed your EtherLab software) using &quot;ethercat 
stop&quot; command (note that it is not the EtherLab command line interface placed 
in /opt/etherlab/bin which has the same name); it can be restarted using 
&quot;ethercat start&quot; command (both commands require root privileges).

But this can be easily checked using &quot;ifconfig&quot; command. If your NIC is 
listed under the name eth1 (as you specified) and you are sure it is the 
right interface (check the MAC address too), than SOEM should work fine. If 
there is no such interface, maybe IgH EtherLab deactivated vanilla NIC 
drivers.

&gt;<i> 3) Data is send out but does not return
</I>&gt;<i> 4) Data is not send out (driver setting, network cable)
</I>&gt;<i> 
</I>&gt;<i> The best way to solve this quickly is NOT to send dozens of mails 
</I>&gt;<i> with no real info, but to send a wireshark trace of the simple_test 
</I>&gt;<i> and/or slaveinfo. Mention the exact type of slave, and references to 
</I>&gt;<i> internet docu (ones that are not broken). If possible send the 
</I>&gt;<i> configuration of the slave and/or the ESI xml file. For good measure 
</I>&gt;<i> the output of ifconfig and lsmod. Then I can really answer your question.
</I>&gt;<i> 
</I>&gt;<i> Regards, Arthur Ketels.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Soem-user mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/soem-user">Soem-user at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/soem-user">https://lists.berlios.de/mailman/listinfo/soem-user</A>
</I>

--
Mladen Knezic, MSc. E. E.
Research and Teaching Assistant
Faculty of Electrical Engineering
Banja Luka, Bosnia and Herzegovina
Web: www.etfbl.net


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000035.html">[Soem-user] First questions about SOEM
</A></li>
	<LI>Next message: <A HREF="000037.html">[Soem-user] First questions about SOEM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/soem-user">More information about the Soem-user
mailing list</a><br>
</body></html>
